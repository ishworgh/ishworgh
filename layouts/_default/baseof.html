<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ .Title }}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="/css/fonts.css">

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <script src="/js/tailwindcss.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        bg: 'var(--bg-color)',
                        text: 'var(--text-color)',
                        primary: 'var(--primary-color)',
                        secondary: 'var(--secondary-color)',
                        accent: 'var(--accent-color)',
                        surface: 'var(--surface-color)',
                        border: 'var(--border-color)',
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="/css/themes.css">
    <script src="/js/feather.min.js"></script>
</head>

<body class="bg-bg text-text font-sans min-h-screen flex flex-col">
    <!-- Theme Init Script to prevent flash -->
    <script>
            (function () {
                const mode = localStorage.getItem('themeMode') || 'auto';
                const palette = localStorage.getItem('themePalette') || 'catppuccin';
                const sysMode = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                const finalMode = mode === 'auto' ? sysMode : mode;

                const variants = {
                    catppuccin: { light: 'latte', dark: 'mocha' },
                    solarized: { light: 'light', dark: 'dark' },
                    tokyonight: { light: 'day', dark: 'storm' },
                    evergreen: { light: 'light', dark: 'dark' },
                    gruvbox: { light: 'light', dark: 'dark' },
                    dracula: { light: 'light', dark: 'dark' },
                    nord: { light: 'light', dark: 'dark' },
                    onedark: { light: 'light', dark: 'dark' },
                    rosepine: { light: 'light', dark: 'dark' },
                    breeze: { light: 'light', dark: 'dark' }
                };

                document.documentElement.className = `theme-${palette}-${variants[palette][finalMode]}`;
            })();
    </script>

    <!-- Navbar -->
    {{ if eq .Title "Bookmarks" }}
    <!-- Bookmarks Page - Floating Elements -->
    <nav class="sticky top-4 z-50 px-4 mb-8">
        <div class="container mx-auto max-w-5xl flex justify-between items-center">
            <!-- Logo -->
            <a href="/"
                class="text-lg font-bold font-mono tracking-wider hover:text-primary transition-colors flex items-center gap-1 group animate-float">
                <span class="text-primary">&gt;</span> ISHWOR<span class="animate-pulse text-primary">_</span>
            </a>

            <!-- Theme Toggle -->
            <button id="settings-btn"
                class="p-2 rounded-full hover:bg-bg text-secondary hover:text-primary transition-colors"
                aria-label="Theme Settings">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="feather feather-monitor">
                    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                    <line x1="8" y1="21" x2="16" y2="21"></line>
                    <line x1="12" y1="17" x2="12" y2="21"></line>
                </svg>
            </button>
        </div>
    </nav>
    {{ else }}
    <!-- Other Pages - Box with Navigation -->
    <nav class="sticky top-4 z-50 px-4 mb-8">
        <div class="container mx-auto max-w-5xl">
            <div
                class="bg-surface/80 backdrop-blur-md border border-border/50 rounded-full shadow-lg px-6 py-3 flex justify-between items-center">

                <!-- Logo -->
                <a href="/"
                    class="text-lg font-bold font-mono tracking-wider hover:text-primary transition-colors flex items-center gap-1 group animate-float">
                    <span class="text-primary">&gt;</span> ISHWOR<span class="animate-pulse text-primary">_</span>
                </a>

                <!-- Desktop Menu -->
                <div class="hidden md:flex items-center gap-1">
                    {{ range .Site.Menus.main }}
                    <a href="{{ .URL }}"
                        class="px-4 py-2 rounded-full text-sm font-medium text-secondary hover:text-primary hover:bg-primary/10 transition-all duration-300 hover:scale-105 hover:-translate-y-0.5"
                        {{ if eq .Identifier "bookmarks" }}target="_blank" {{ end }}>
                        {{ .Name }}
                    </a>
                    {{ end }}
                </div>

                <!-- Mobile Menu Button & Theme Toggle -->
                <div class="flex items-center gap-2">
                    <!-- Mobile Menu Toggle -->
                    <button id="mobile-menu-btn"
                        class="md:hidden p-2 rounded-full hover:bg-bg text-secondary hover:text-primary transition-colors">
                        <i data-feather="menu" class="w-5 h-5"></i>
                    </button>

                    <!-- Theme Toggle -->
                    <button id="settings-btn"
                        class="p-2 rounded-full hover:bg-bg text-secondary hover:text-primary transition-colors"
                        aria-label="Theme Settings">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            class="feather feather-monitor">
                            <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                            <line x1="8" y1="21" x2="16" y2="21"></line>
                            <line x1="12" y1="17" x2="12" y2="21"></line>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Mobile Menu Dropdown -->
            <div id="mobile-menu"
                class="md:hidden hidden mt-2 bg-surface/95 backdrop-blur-md border border-border rounded-2xl shadow-lg p-4 animate-slideDown">
                <nav class="flex flex-col gap-2">
                    {{ range .Site.Menus.main }}
                    <a href="{{ .URL }}"
                        class="px-4 py-3 rounded-lg text-sm font-medium text-secondary hover:text-primary hover:bg-bg transition-all"
                        {{ if eq .Identifier "bookmarks" }}target="_blank" {{ end }}>
                        {{ .Name }}
                    </a>
                    {{ end }}
                </nav>
            </div>
        </div>
    </nav>
    {{ end }}

    <!-- Main Content -->
    <main class="flex-grow container mx-auto p-4">
        {{ block "main" . }}{{ end }}
    </main>

    <!-- Footer -->
    <footer class="p-4 border-t border-border text-center text-sm opacity-70 mt-8">
        &copy; Ishwor Ghimire, {{ now.Year }}
    </footer>

    <!-- Scroll to Top Button -->
    <button id="scroll-to-top"
        class="fixed bottom-8 right-8 w-12 h-12 bg-primary text-bg rounded-full shadow-lg opacity-0 pointer-events-none transition-all duration-300 hover:scale-110 hover:shadow-xl z-40 flex items-center justify-center">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="12" y1="19" x2="12" y2="5"></line>
            <polyline points="5 12 12 5 19 12"></polyline>
        </svg>
    </button>

    <!-- Settings Modal -->
    <div id="settings-modal" class="fixed top-20 right-8 hidden z-50 animate-slideDown">
        <div class="bg-surface p-6 rounded-2xl shadow-2xl w-96 border border-border">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-primary">Theme Settings</h2>
                <button id="close-settings" class="p-1 hover:bg-bg rounded-lg transition-colors">
                    <i data-feather="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div id="theme-controls">
                <div class="mb-6">
                    <h3 class="text-sm font-bold text-secondary uppercase tracking-wider mb-3">Mode</h3>
                    <div class="flex bg-bg rounded-lg p-1 border border-border">
                        <button id="btn-mode-light"
                            class="flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all text-secondary hover:text-text">
                            <i data-feather="sun" class="w-4 h-4"></i> Light
                        </button>
                        <button id="btn-mode-auto"
                            class="flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all text-secondary hover:text-text">
                            <i data-feather="monitor" class="w-4 h-4"></i> Auto
                        </button>
                        <button id="btn-mode-dark"
                            class="flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all text-secondary hover:text-text">
                            <i data-feather="moon" class="w-4 h-4"></i> Dark
                        </button>
                    </div>
                </div>
                <div>
                    <h3 class="text-sm font-bold text-secondary uppercase tracking-wider mb-3">Palette</h3>
                    <div id="palette-grid" class="grid grid-cols-2 gap-2">
                        <!-- Palettes will be injected here since they are dynamic config -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <style>
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-3px);
            }
        }

        .animate-slideDown {
            animation: slideDown 0.2s ease-out;
        }

        .animate-float {
            animation: float 3s ease-in-out infinite;
        }

        #settings-modal:not(.hidden) {
            display: block;
        }
    </style>

    <script src="/js/main.js?v={{ now.Unix }}"></script>
    <script>feather.replace()</script>
</body>

</html>